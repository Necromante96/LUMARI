<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin â€” LUMARI</title>
  <link rel="stylesheet" href="../css/styles.css">
  <style>
    .admin-wrap{max-width:900px;margin:0 auto}
    .grid{display:grid;gap:14px}
    .card{padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.08);background:linear-gradient(180deg, rgba(255,255,255,0.04), transparent)}
    textarea{width:100%;min-height:200px;padding:12px;border-radius:10px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.16);color:#fff}
    .btn{margin-top:10px}
  </style>
</head>
<body>
  <header class="topbar" role="banner" aria-label="Barra de navegaÃ§Ã£o">
    <div class="topbar-inner">
      <a href="../index.html" class="brand-mini" aria-label="LUMARI home">
        <img src="../logo/logo.jpg" alt="LUMARI" class="logo-mini">
      </a>
      <nav class="nav" role="navigation" aria-label="Menu principal">
        <a href="about.html">Quem somos?</a>
        <a href="features.html">Funcionalidades</a>
        <a href="updates.html">AtualizaÃ§Ãµes</a>
        <span class="version-badge" aria-label="VersÃ£o atual">v0.0.8-alfa</span>
      </nav>
    </div>
  </header>

  <button id="audioToggle" class="audio-toggle" aria-pressed="false" aria-label="Ativar som">ðŸ”Š</button>

  <main class="container">
    <section class="admin-wrap intro">
      <h1>Admin</h1>
  <p class="muted">UtilitÃ¡rio opcional: vocÃª pode manter uma base local de usuÃ¡rios no navegador. O login padrÃ£o usa a base de cadastro local (lumari_users).</p>
      <div class="grid">
        <div class="card">
          <h3>Base de usuÃ¡rios (JSON)</h3>
          <textarea id="usersJson" spellcheck="false" placeholder='[
  { "email":"user@example.com", "name":"User", "role":"public", "passHash":"...sha256..." }
]'></textarea>
          <div>
            <button class="btn" id="btnLoad">Carregar atual</button>
            <button class="btn" id="btnSave">Salvar</button>
            <button class="btn" id="btnClear">Limpar base</button>
          </div>
          <p class="muted" style="margin-top:8px">Dica: para gerar passHash, use o cadastro normal (ele cria o hash) e depois copie do arquivo baixado anteriormente ou temporariamente da base cache local.</p>
        </div>
        <div class="card">
          <h3>Exportar / Importar</h3>
          <button class="btn" id="btnExport">Exportar JSON</button>
          <input type="file" id="fileImport" accept="application/json" style="display:block;margin-top:10px"/>
        </div>
      </div>
    </section>
  </main>

  <script defer src="../js/main.js"></script>
  <script>
    (function(){
      const ta = document.getElementById('usersJson');
  function get(){ try{ return JSON.parse(localStorage.getItem('lumari_users')||'[]'); }catch(e){ return []; } }
  function set(v){ try{ localStorage.setItem('lumari_users', JSON.stringify(v)); }catch(e){} }
      function pretty(v){ try{ return JSON.stringify(v, null, 2); }catch(e){ return '[]'; } }
      document.getElementById('btnLoad').addEventListener('click', ()=>{ ta.value = pretty(get()); });
      document.getElementById('btnSave').addEventListener('click', ()=>{
        try{ const parsed = JSON.parse(ta.value||'[]'); if(Array.isArray(parsed)) set(parsed); alert('Salvo!'); }catch(e){ alert('JSON invÃ¡lido'); }
      });
      document.getElementById('btnClear').addEventListener('click', ()=>{ set([]); ta.value = '[]'; alert('Base limpa.'); });
      document.getElementById('btnExport').addEventListener('click', ()=>{
        const v = pretty(get());
        const blob = new Blob([v], {type:'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href=url; a.download='users.json'; a.click(); URL.revokeObjectURL(url);
      });
      document.getElementById('fileImport').addEventListener('change', (e)=>{
        const f = e.target.files && e.target.files[0]; if(!f) return;
        const r = new FileReader();
        r.onload = ()=>{ try{ const j = JSON.parse(String(r.result||'[]')); if(Array.isArray(j)){ set(j); ta.value = pretty(j); alert('Importado e salvo.'); } else { alert('JSON deve ser um array'); } }catch(err){ alert('Falha ao importar'); } };
        r.readAsText(f);
      });
      // carregamento inicial
      ta.value = pretty(get());
    })();
  </script>
</body>
</html>